1.不同频率分钟线计算ma7/ma25结果的差异:
1)横盘阶段，5min和15min分钟线计算双均线的值存在相等的情况，即差异为0
2)消息日/行情快速变动阶段，5min和15min计算的双均线结果存在较大差异，最大值可为
a.ma7:118
b.ma25:141
注:以上统计结果为ETH
3)10min线和5min线对比,最大差异为:
a.ma7:84.7
b.ma25:87.14
计算结果存在时间上的滞后性

2.双均线ma7/ma25的差异(绝对值)，与klines的关系：
参数:abs_diff
1)统计分析:
    a.5min:存在abs_diff近似等于0的情况，
        每个abs_diff尖峰大都服从正态分布，双峰/多峰/单峰
    b.15min:同上
    c.10min:同上
2)abs_diff的峰值和历史时段最高/最低价格的关系:
# TODO：只看5min，可以峰值点，作为开空/平空（多）的点位（大部分符合趋势） ok
1.置信区间/阈值:
    a.5min:
2.考虑ma7/ma25的大小关系，对已经作为筛选的峰值（阈值划分）加标签，开多/空/平仓
    a.标签似乎打不出来

# TODO:K线突破ma均线的测试？ ok

# TODO:
test: 根据历史数据，计算过往时段的波动幅度情况，计算方法为:
a.统计abs_diff的最小值，取一个置信区间，在某个置信区间内，将置信度5%边界的信号略去
即此处不做无用的开仓操作
    i.对5min线来说，同一长度时间段内，出现的开仓机会较多，
    最小扰动（小峰）的峰值较小
    ii.15min最小扰动（小峰）峰值较高，同时开仓机会也较小
    偶尔不服从单一峰的正态分布，而是双峰的正态分布
b.策略执行可行性分析:
    由于存在单/双峰的情况，两种场景需要分别分析，找到可以兼容两类情况的共同点
    i.单峰：在峰值出现的时候，进行平仓（多/空）
    ii.双峰：根据是否进行滚仓的情况判断，在第一个峰进行平仓止盈，进入第一个波谷时再次开仓，第二个峰止盈
        1）波峰和波谷之间的深度：拟以最大回撤类比分析
    iii.多峰：是由下跌或上涨过程中出现的偶尔反弹导致
   # TODO:
   test:当存在双峰/多峰的情况时，统计从波峰到波谷之间的最大回撤，和最小回弹情况
   i.多峰:
        1）从最高的波峰，到接下来第一个波谷的最大回撤&最小回撤 max_resp,min_resp
        2）从第一个波谷，到第二个波峰的最小回弹&最大回弹min_recv,max_recv
        3）...
    拟执行策略：
        1）当回弹<min_recv最小回弹，忽略；否则执行做空/做多
        2）当回撤<min_resp最小回撤，忽略；否则执行做空/做多
        3）max_recv结合ma7&ma25的大小情况分析

# TODO: ok
test:用5min线计算的ma作为潜在的平仓信号


1.24 实盘上线开仓的程序，平仓手动
# his_highest 跑全年15min的开仓点位
# TODO:1.打标签，-1开空/平多，1开多/平空  ok
# 2.最开始没有仓位

data=pd.read_csv("add_action_15min_eth.csv")
adj_data=data[data['action']!=0].reset_index(drop=True)
adj_data['action'].iloc[4:54]

# 暂时将均线ma_v1的版本上实盘

# TODO:1.每年对应的阈值要调整，有时候波动率大，那就用3，波动小，用1也行；具体是什么值，要通过训练确定
#   2.需要更多的历史训练结果(ma值)


# 分析一下此策略对BTC的效果，找到合适的阈值